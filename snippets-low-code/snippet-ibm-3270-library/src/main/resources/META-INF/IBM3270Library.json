{"id":"IBM3270Library","robotType":"NANO","mainClass":"com.appian.rpa.library.ibm3270.IBM3270Library","actions":["init","maximizeWindow","tryHacl","tryEhlapi","cleanUp"],"conditionalActions":[],"fieldLinks":[{"fieldName":"robot","fieldLinkValue":"::robot"}],"actionDetails":[{"id":"init","implementation":"/**\n\t * Initialization of the library. This method is called prior to any other\n\t * method in the library.\n\t */\n@Override\npublic void init() {\n    server = (IJidokaServer<Serializable>) JidokaFactory.getServer();\n    client = IClient.getInstance(robot);\n}"},{"id":"maximizeWindow","implementation":"/**\n\t * Maximize Window\n\t */\n@JidokaMethod(name = \"IBM Maximize Window\", description = \"IBM3270Library:v1.0.0: Maximizes the window\")\npublic void maximizeWindow() throws JidokaFatalException {\n    ibm3270Commons.maximizeWindow();\n}"},{"id":"tryHacl","implementation":"@JidokaMethod(name = \"IBM Try HACL\", description = \"IBM3270Library:v1.0.0: Trying HACL\")\npublic void tryHacl() throws JidokaException, ECLErr, InterruptedException {\n    Properties prop = new  Properties();\n    File f = new  File(\"C:\\\\Program Files (x86)\\\\IBM\\\\Personal Communications\\\\private\\\\GSO1tls-MAI.ws\");\n    server.debug(\"Print file exists: \" + f.exists());\n    prop.put(\"SESSION_HOST\", \"C:\\\\Program Files (x86)\\\\IBM\\\\Personal Communications\\\\private\\\\GSO1tls-MAI.ws\");\n    //\t\tprop.put(\"SESSION_HOST\", \"GSO1tls-MAI.ws\");\n    //\t\tprop.put(\"SESSION_HOST\", \"c:\\\\program files (x86)\\\\ibm\\\\personal communications\\\\private\\\\gso1tls-mai.ws\");\n    prop.put(\"SESSION_WIN_STATE\", \"MAX\");\n    prop.put(\"SESSION_VT_KEYPAD \", \"SESSION_VT_KEYPAD_APPL\");\n    prop.put(\"SESSION_VT_LOCAL_ECHO\", \"SESSION_VT_LOCAL_ECHO_ON\");\n    //\t\tprop.put(ECLSession.SESSION_HOST_PORT, \"992\");\n    try {\n        ECLSession session = new  ECLSession(prop);\n        server.debug(\"Print prop session host: \" + prop.get(ECLSession.SESSION_HOST));\n        server.debug(\"Print prop port: \" + prop.get(ECLSession.SESSION_HOST_PORT));\n        server.debug(\"Print session label: \" + session.getSessionLabel());\n        server.debug(\"Print session host1: \" + session.getHost(0));\n        server.debug(\"Print session host2: \" + session.GetHost());\n        server.debug(\"Print session hostid: \" + session.GetHostid());\n        server.debug(\"Print session properties: \" + session.getProperties());\n        session.StartCommunication();\n        Thread.sleep(5000);\n        if (!(session).IsCommStarted()) {\n            //\n            try {\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                server.debug(\"Exception: \" + e.getMessage());\n            }\n        }\n        server.debug(\"Print IsCommStarted: \" + session.IsCommStarted());\n        server.debug(\"Print isConnected: \" + session.isConnected());\n        session.connect();\n        //\t\t\tThread.sleep(10000);\n        //\t\t\tserver.debug(\"Print2 IsCommStarted: \" + session.IsCommStarted());\n        //\t\t\tserver.debug(\"Print2 isConnected: \" + session.isConnected());\n        ECLOIA eclOIA = session.GetOIA();\n        ECLPS ps = session.GetPS();\n        server.debug(\"Print oia insert mode: \" + eclOIA.IsInsertMode());\n        server.debug(\"Print ps1 row: \" + ps.GetCursorRow());\n        server.debug(\"Print ps1 col: \" + ps.GetCursorCol());\n        session.GetPS().SetCursorPos(10, 10);\n        server.debug(\"Print ps2 row: \" + ps.GetCursorRow());\n        server.debug(\"Print ps2 col: \" + ps.GetCursorCol());\n        session.GetPS().SendKeys(\"XYZ\");\n        // Screen size is assumed to be 24x80\n        char[] temp = new char[1921];\n        ps.GetScreen(temp, 1920, 1, 1920, ps.TEXT_PLANE);\n        server.debug(\"Print screen: \" + new  String(temp));\n        ECLFieldList fieldList = session.GetPS().GetFieldList();\n        server.debug(\"Print field: \" + fieldList.FindField(1, 2).getString());\n    } catch (ECLErr e) {\n        System.out.println(e.GetMsgText());\n    }\n}"},{"id":"tryEhlapi","implementation":"@JidokaMethod(name = \"IBM Try EHLAPI\", description = \"IBM3270Library:v1.0.0: Trying EHLAPI\")\npublic void tryEhlapi() throws JidokaException, ECLErr, InterruptedException, NoSuchFieldException, IllegalAccessException {\n    //\t1\n    System.setProperty(\"jna.library.path\", \"C:\\\\Program Files (x86)\\\\IBM\\\\Personal Communications\");\n    //\t2\n    //\t\tSystem.setProperty(\"jna.library.path\", \"C:\\\\Program Files (x86)\\\\IBM\\\\Personal Communications\");\n    //\t\t//set sys_paths to null\n    //\t\tfinal Field sysPathsField = ClassLoader.class.getDeclaredField(\"sys_paths\");\n    //\t\tsysPathsField.setAccessible(true);\n    //\t\tsysPathsField.set(null, null);\n    //\t3\n    //\t\tString prop = System.getProperty(\"jna.library.path\");\n    //\t\tif (prop == null || prop.isEmpty()) {\n    //\t\t\tprop = \"C:/Program Files (x86)/IBM/Personal Communications\";\n    //\t\t} else {\n    //\t\t\tprop += \";C:/Program Files (x86)/IBM/Personal Communications\";\n    //\t\t}\n    //\t\tSystem.setProperty(\"jna.library.path\", prop);\n    //Load the ehll api\n    EHllApi eHllApi = Native.loadLibrary(\"pcshll32\", EHllApi.class, W32APIOptions.DEFAULT_OPTIONS);\n    //\t\tHard-coding inputs for now\n    String example = \"A\";\n    byte[] dta = example.getBytes();\n    int func = EHllApi.HA_CONNECT_PS;\n    int pos = 0;\n    // object to return with results from call to hllApi\n    HllApiVal hav = new  HllApiVal();\n    int inputDtaLength = dta.length;\n    Pointer dtaPtr = new  Memory(inputDtaLength);\n    if (dta != null)\n        dtaPtr.write(0, dta, 0, inputDtaLength);\n    IntByReference funcIntPtr = new  IntByReference(func);\n    IntByReference dtaLenPtr = new  IntByReference(inputDtaLength);\n    IntByReference posIntPtr = new  IntByReference(pos);\n    eHllApi.hllapi(funcIntPtr, dtaPtr, dtaLenPtr, posIntPtr);\n    // code returned by function call\n    hav.hllApiCod = posIntPtr.getValue();\n    // length of byte array returned\n    hav.hllApiLen = dtaLenPtr.getValue();\n    // byte array returned\n    hav.hllApiDta = dtaPtr.getByteArray(0, inputDtaLength);\n    // length of input byteArray\n    hav.srcDataLen = inputDtaLength;\n    server.debug(\"hav1 is: \" + hav.hllApiDta);\n    //\t\tHard-coding inputs for now\n    String example2 = \"steve rules\";\n    byte[] dta2 = example2.getBytes();\n    int func2 = EHllApi.HA_SENDKEY;\n    int pos2 = 0;\n    // object to return with results from call to hllApi\n    HllApiVal hav2 = new  HllApiVal();\n    int inputDtaLength2 = dta2.length;\n    Pointer dtaPtr2 = new  Memory(inputDtaLength2);\n    if (dta2 != null)\n        dtaPtr2.write(0, dta2, 0, inputDtaLength2);\n    IntByReference funcIntPtr2 = new  IntByReference(func2);\n    IntByReference dtaLenPtr2 = new  IntByReference(inputDtaLength2);\n    IntByReference posIntPtr2 = new  IntByReference(pos2);\n    eHllApi.hllapi(funcIntPtr2, dtaPtr2, dtaLenPtr2, posIntPtr2);\n    // code returned by function call\n    hav2.hllApiCod = posIntPtr2.getValue();\n    // length of byte array returned\n    hav2.hllApiLen = dtaLenPtr2.getValue();\n    // byte array returned\n    hav2.hllApiDta = dtaPtr2.getByteArray(0, inputDtaLength2);\n    // length of input byteArray\n    hav2.srcDataLen = inputDtaLength2;\n    server.debug(\"hav2 is: \" + hav2.hllApiDta);\n}"},{"id":"cleanUp","implementation":"No source code available"}],"conditionalActionDetails":[],"sdkMethods":[{"id":"getTextAtLine","returnClazz":"java.lang.String","attributes":{"returnClass":"AS_DEFINED","name":"IBM Get Text at Line","description":"IBM3270Library:v1.0.0: Takes in a line number (emulator y coordinate starting at 1) and returns the text at that line","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Line Number","placeholderText":"","optionsService":"NONE","id":"Line Number","clazz":"","validate":""}]}]},{"id":"goToCoordinates","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Go to Coordinates","description":"IBM3270Library:v1.0.0: Takes in a x y int list coordinates and goes to that position in emulator with an offset","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"X Coordinate","placeholderText":"","optionsService":"NONE","id":"X Coordinate","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Y Coordinate","placeholderText":"","optionsService":"NONE","id":"Y Coordinate","clazz":"","validate":""}]}]},{"id":"goToTextPosition","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Go to Text Position","description":"IBM3270Library:v1.0.0: Takes in a text string and goes to that position in emulator","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Text to Locate","placeholderText":"","optionsService":"NONE","id":"Text to Locate","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"X Offset","placeholderText":"","optionsService":"NONE","id":"X Offset","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Y Offset","placeholderText":"","optionsService":"NONE","id":"Y Offset","clazz":"","validate":""}]}]},{"id":"findText","returnClazz":"java.util.List","attributes":{"returnClass":"AS_DEFINED","name":"IBM Find Text","description":"IBM3270Library:v1.0.0: Takes in a text string and returns the xy location (integer array) in the emulator","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Text to Locate","placeholderText":"","optionsService":"NONE","id":"Text to Locate","clazz":"","validate":""}]}]},{"id":"writeHere","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Write Here","description":"IBM3270Library:v1.0.0: Writes text in emulator at current location (handles slow typing & special characters","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Text to Write","placeholderText":"","optionsService":"NONE","id":"Text to Write","clazz":"","validate":""}]}]},{"id":"maximizeWindow","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Maximize Window","description":"IBM3270Library:v1.0.0: Maximizes the window","iconClass":"jf-console"},"parameters":[]},{"id":"setEmulator","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Set Emulator","description":"IBM3270Library:v1.0.0: Sets the correct emulator type (PCOMM or W3270)","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Window Title Xpath","placeholderText":"","optionsService":"NONE","id":"Window Title Xpath","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Emulator Type","placeholderText":"","optionsService":"NONE","id":"Emulator Type","clazz":"","validate":""}]}]},{"id":"tryHacl","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Try HACL","description":"IBM3270Library:v1.0.0: Trying HACL","iconClass":"jf-console"},"parameters":[]},{"id":"tryEhlapi","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Try EHLAPI","description":"IBM3270Library:v1.0.0: Trying EHLAPI","iconClass":"jf-console"},"parameters":[]},{"id":"writeAtLabel","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Write at Label","description":"IBM3270Library:v1.0.0: Writes text in emulator at specified label with optional offset (handles slow typing & special characters","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Field Label","placeholderText":"","optionsService":"NONE","id":"Field Label","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"X Offset","placeholderText":"","optionsService":"NONE","id":"X Offset","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Y Offset","placeholderText":"","optionsService":"NONE","id":"Y Offset","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Text to Write","placeholderText":"","optionsService":"NONE","id":"Text to Write","clazz":"","validate":""}]}]},{"id":"writeAtCoordinates","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Write at Coordinates","description":"IBM3270Library:v1.0.0: Writes text in emulator at specified location (handles slow typing & special characters","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"X Coordinate","placeholderText":"","optionsService":"NONE","id":"X Coordinate","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Y Coordinate","placeholderText":"","optionsService":"NONE","id":"Y Coordinate","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Text to Write","placeholderText":"","optionsService":"NONE","id":"Text to Write","clazz":"","validate":""}]}]},{"id":"enterCredentialByUsername","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Enter Credential","description":"IBM3270Library:v1.0.0: Enters credentials into emulator","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Application Name for Credentials","placeholderText":"","optionsService":"NONE","id":"Application Name for Credentials","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Username for Credentials","placeholderText":"","optionsService":"NONE","id":"Username for Credentials","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"ENUMERATOR","rendition":["OPTIONS_EXPAND_HORIZONTALLY"],"validateMsg":"","name":"Is Username? Otherwise Password","placeholderText":"","optionsService":"JIDOKA_PARAMETER_BOOLEAN","id":"Is Username? Otherwise Password","clazz":"com.novayre.jidoka.client.api.EJidokaParameterBoolean","validate":""}]}]},{"id":"getTextAtCoordinate","returnClazz":"java.lang.String","attributes":{"returnClass":"AS_DEFINED","name":"IBM Get Text at Coordinate","description":"IBM3270Library:v1.0.0: Takes in a coordinate(emulator x y coordinate starting at 1) and length of text to return from that line, then returns the text located there","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"X Coordinate","placeholderText":"","optionsService":"NONE","id":"X Coordinate","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Y Coordinate","placeholderText":"","optionsService":"NONE","id":"Y Coordinate","clazz":"","validate":""},{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Text Length to Read","placeholderText":"","optionsService":"NONE","id":"Text Length to Read","clazz":"","validate":""}]}]},{"id":"bulkWriteAtCoordinates","returnClazz":"void","attributes":{"returnClass":"AS_DEFINED","name":"IBM Bulk Write at Coordinates","description":"IBM3270Library:v1.0.0: Writes text in bulk at specified locations (handles slow typing & special characters","iconClass":"jf-console"},"parameters":[{"id":"arg0","clazz":"com.novayre.jidoka.client.api.SDKParameterMap","enumValues":[],"attributes":{"jsonMap":"","defaultValue":"","name":"Nested parameters","type":"NESTED"},"nestedParameters":[{"dependsOn":"","defaultValue":"","groupId":"","multiple":false,"colWidth":100,"tooltip":"","instructionalText":"Expects JSON list object with fields 'text', 'x', and 'y' - for example a!toJson({{text:\"test1\",x:1,y:1},{text:\"test2\",x:5,y:5}})","serviceBasedFeatureToggle":"DEFAULT","type":"AS_DEFINED","rendition":[],"validateMsg":"","name":"Bulk Test & XY Coordinates (JSON)","placeholderText":"","optionsService":"NONE","id":"Bulk Test & XY Coordinates (JSON)","clazz":"","validate":""}]}]}]}